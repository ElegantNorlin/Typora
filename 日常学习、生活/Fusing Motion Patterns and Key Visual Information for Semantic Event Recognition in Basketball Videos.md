### Fusing Motion Patterns and Key Visual Information for Semantic Event Recognition in Basketball Videos

#### 摘要

在篮球比赛分析的具体案例中，每一轮的成功得分都可以通过篮筐周围出现的变化来可靠地检测出来。在此基础上，提出了一种融合全局和局部运动模式（MPs）和关键视觉信息（KVI）的篮球视频语义事件识别方法。首先，根据摄像机调整的内在特性，提出了一种基于混合运动的全局运动估计算法。由混合运动和整体运动可以得到局部运动。其次，在分离的全局和局部运动模式上，利用双流3D CNN框架进行群体活动识别。第三，通过CNN结构提取篮筐的外观结构特征被用来预测成功或失败。

#### 介绍

![image-20210307152833385](/Users/wanwan/Library/Application Support/typora-user-images/image-20210307152833385.png)  

提出了融合全局和局部运动模式和关键视觉信息分离的框架：视频帧同时输入到两个管道中，第一个管道是分离全局运动和局部运动，并利用双流3D CNN模块来表示运动模式，用于群体活动识别。第二个管道中，使用CNN模型从检测到的篮筐区域提取出KVI，用于表示进攻成功或者失败。结合群体活动识别和进攻的成功与否，来推断篮球视频中的语义事件。（语义事件：用于表示用户动作的事件。）

#### 全局和局部运动分离

![image-20210307211529254](https://gitee.com/wanwanzh/imagebed/raw/master/pictures/image-20210307211529254.png)  

* a:混合运动
* b:直接从混合运动减去全局运动得到的局部运动
* c:基于阈值的局部运动

通过什么方法将全局和局部运动分离呢？

我们先使用下列颜色编码来表示不同颜色级别所代表的摄像机不同的运动方向，颜色强度表示运动的幅度。

![image-20210307212233974](https://gitee.com/wanwanzh/imagebed/raw/master/pictures/image-20210307212233974.png) 

图5:彩色编码格式的基本摄像机运动:(a)左平移。全局运动显示为所有像素中具有相同振幅的右运动。(b)平底锅。全局运动显示为左运动，在所有像素中具有相同的振幅。(c)倾斜。全局运动显示为向上运动，在所有像素中具有相同的振幅。(d)倾斜下来。全局运动显示为向下运动，在所有像素中具有相同的振幅。(e)放大。全局运动表现为径向向中心点的运动。运动振幅从中心减小到周长(f)缩小。全局运动表现为径向远离中心点的运动。运动振幅从中心到周长递减。

![image-20210307213936733](https://gitee.com/wanwanzh/imagebed/raw/master/pictures/image-20210307213936733.png) 

* 第一行是输入帧
* 第二行是混合运动
* 第三行是全局运动
* 第四行是局部运动

##### 从混合运动流中分离全局运动

按照我们的编码规则，如果我们得到了四个角点的运动向量，通过相应端点的线性插值可以得到全局运动场四条边缘线上的运动分量，然后通过线性插值得到非边缘点的运动分量，从而得到全局运动。

##### 从混合运动中分离局部运动

通过混合运动减去全局运动得到局部运动是一种方法，但是这种方法可能产生一些噪声。

我们设计了一种基于阈值的局部运动估计方法。

（x1,y1），（x2,y2），（x3,y3）分别为混合流场、全局运动场、局部运动场的点。其中r(a,a) = √xa^2+ya^2

那么局部运动可以估计为

<img src="https://gitee.com/wanwanzh/imagebed/raw/master/pictures/image-20210307220534226.png" alt="image-20210307220534226" style="zoom:67%;" /> 

#### 融合MPs和KVI的识别

##### 通过运动模式（MPs）识别群体活动

我们利用双流3DCNN结构将全局和局部的运动模式结合起来进行群体活动识别。两个流中的网络结构是相同的。每个3D CNN结构都有五个3D卷积层，分别有64、128、128、256、256个**feature map**，然后是三个全连接层的维度2048、2048和活动类数（6）的层。批处理标准化层在每-一个卷积层和前两个完全连接层之后进行连接。除了第一个池化层的内核大小被设置为2 X2X1外，我们在所有核大小为2X2X2的池化层中都使用了最大池化。给定一个视频片段，全局运动和局部数据被依次输入到相应的网络流中。输出的是6个小组活动(3分、罚球、上篮、2分、扣篮和抢断)的**概率分布**。

##### 使用关键的视觉信息（KVI）预测成功/失败

成功或失败可以通过球是否随着网的运动而落入篮框来有效地识别，如图2所示。基于这一点，构建了一种关键的基于视觉信息的成功失败预测方案。检测篮区域，提取篮区域的外观特征，进行成功/失败预测。为了提高实时性，采用SSD单弹检测(Single Shot Detection, SSD)模型对篮筐进行检测，利用AlexNet结构对篮筐进行外观特征提取。此外，考虑到球在篮筐中的成功只能持续几帧的事实，我们设计了一种策略，只要球在篮筐中的一帧被预测成功，就被认为是成功的，否则就被认为是失败的。

##### 两条管道融合

从两条管道中，我们可以得到群组活动和成功/失败的预测结果，我们把两个结果编码成二进制向量。概率最高的元素被赋值为1，其他元素被赋值为0。然后利用Kronecker乘积运算将这两个结果融合为语义识别结果。

或许可以这样理解：

* 群组活动结果的概率最高的元素编码为1

* 成功/失败概率最高的元素编码为1

* 将编码好的结果带入**kronecker**公示

  群组活动编码一定是1，成功/失败的编码可能为1，也可能为0.

  > 有以下两种结果
  >
  > * 结果为1表征群组活动进行了且球进了
  > * 结果为0表征群组活动进行了，但是球没进（包括抢断活动）

**kronecker**（克罗内克符号）

![image-20210307201716715](https://gitee.com/wanwanzh/imagebed/raw/master/pictures/image-20210307201716715.png) 



